{{ $id := printf "abc407c-security-device-%d" (now.UnixNano) }}

<div class="atcoder-device" id="{{ $id }}">
    <div class="device-screen">
        <span class="display-text"></span>
    </div>
    <div class="device-buttons">
        <button class="button-a">Button A</button>
        <button class="button-b">Button B</button>
        <button class="button-clear">Clear</button>
    </div>
    <div class="device-target">
        <label for="target-input">Target String:</label>
        <input type="text" id="target-input" placeholder="Enter target string">
        <button class="solve-button">Find Minimum Steps</button>
    </div>
    <div class="device-result">
        <p class="steps-display"></p>
    </div>
</div>

<style>
.atcoder-device {
    max-width: 600px;
    margin: 2rem auto;
    padding: 2rem;
    border: 2px solid #333;
    border-radius: 10px;
    background: #f5f5f5;
}

.device-screen {
    background: #000;
    color: #0f0;
    padding: 1rem;
    margin-bottom: 1rem;
    border-radius: 5px;
    font-family: monospace;
    font-size: 1.5rem;
    min-height: 2.5rem;
    display: flex;
    align-items: center;
}

.device-buttons {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
}

.device-buttons button {
    flex: 1;
    padding: 0.5rem;
    font-size: 1rem;
    cursor: pointer;
    background: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    transition: background 0.3s;
}

.device-buttons button:hover {
    background: #45a049;
}

.button-clear {
    background: #f44336 !important;
}

.button-clear:hover {
    background: #d32f2f !important;
}

.device-target {
    margin: 1rem 0;
    display: flex;
    gap: 0.5rem;
    align-items: center;
    color: #333;
}

.device-target label {
    color: #333;
    white-space: nowrap;
}

.device-target input {
    flex: 1;
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    background: #fff;
    color: #333;
}

.solve-button {
    padding: 0.5rem 1rem;
    background: #2196F3;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.solve-button:hover {
    background: #1976D2;
}

.device-result {
    margin-top: 1rem;
    padding: 1rem;
    background: #fff;
    border-radius: 4px;
    border: 1px solid #ddd;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const device = document.getElementById('{{ $id }}');
    const display = device.querySelector('.display-text');
    const buttonA = device.querySelector('.button-a');
    const buttonB = device.querySelector('.button-b');
    const buttonClear = device.querySelector('.button-clear');
    const targetInput = device.querySelector('#target-input');
    const solveButton = device.querySelector('.solve-button');
    const stepsDisplay = device.querySelector('.steps-display');
    
    let currentString = '';
    
    function updateDisplay() {
        display.textContent = currentString || ' ';
    }
    
    function pressButtonA() {
        currentString += '0';
        updateDisplay();
    }
    
    function pressButtonB() {
        currentString = currentString.split('').map(digit => {
            if (digit === '9') return '0';
            return String(Number(digit) + 1);
        }).join('');
        updateDisplay();
    }

    function clearDisplay() {
        currentString = '';
        updateDisplay();
    }
    
    function findMinimumSteps(target) {
        const queue = [['', 0]];
        const visited = new Set(['']);
        
        while (queue.length > 0) {
            const [current, steps] = queue.shift();
            
            if (current === target) {
                return steps;
            }
            
            // Try pressing button A
            const nextA = current + '0';
            if (!visited.has(nextA)) {
                visited.add(nextA);
                queue.push([nextA, steps + 1]);
            }
            
            // Try pressing button B
            const nextB = current.split('').map(digit => {
                if (digit === '9') return '0';
                return String(Number(digit) + 1);
            }).join('');
            
            if (!visited.has(nextB)) {
                visited.add(nextB);
                queue.push([nextB, steps + 1]);
            }
        }
        
        return -1; // No solution found
    }
    
    buttonA.addEventListener('click', pressButtonA);
    buttonB.addEventListener('click', pressButtonB);
    buttonClear.addEventListener('click', clearDisplay);
    
    solveButton.addEventListener('click', () => {
        const target = targetInput.value;
        if (!target) {
            stepsDisplay.textContent = 'Please enter a target string';
            return;
        }
        
        const steps = findMinimumSteps(target);
        if (steps === -1) {
            stepsDisplay.textContent = 'No solution found';
        } else {
            stepsDisplay.textContent = `Minimum steps required: ${steps}`;
        }
    });
    
    updateDisplay();
});
</script> 
